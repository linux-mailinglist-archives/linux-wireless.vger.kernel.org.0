Return-Path: <linux-wireless-owner@vger.kernel.org>
X-Original-To: lists+linux-wireless@lfdr.de
Delivered-To: lists+linux-wireless@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 9F0947B868D
	for <lists+linux-wireless@lfdr.de>; Wed,  4 Oct 2023 19:29:18 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S243694AbjJDR3R (ORCPT <rfc822;lists+linux-wireless@lfdr.de>);
        Wed, 4 Oct 2023 13:29:17 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:44772 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S243717AbjJDR3P (ORCPT
        <rfc822;linux-wireless@vger.kernel.org>);
        Wed, 4 Oct 2023 13:29:15 -0400
Received: from NAM10-MW2-obe.outbound.protection.outlook.com (mail-mw2nam10on2053.outbound.protection.outlook.com [40.107.94.53])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 5FE12D8;
        Wed,  4 Oct 2023 10:29:10 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=N6XObVHPr0iIOryizxE/4YHBxHulrT5+uD3spZs6bmhWUvOgZVLXg/RTn22QBbG5PvvbjBsehl/o0wjqYDZT7xfX5XHttI0aPF19y1gX6WGfLp18s9s4K+Dxd/3dCsENG9wUInV/K8IWqosxGTSOjRzBxHHUFUgL1ZdIJoqWwVdWNiGTBRmvP/oDmMFORyzkmGFR6MMupp+IwRQ1aUDvjmfYUfieT5xlOUB3DamZ6PqQ7Uu1t/7BSwvyM9a0keZgR5eP++qqpzlPP1CpbCtrgQicJL6G52/t/Wr/DqDj1IB3IXEj5sYVdRD/+05zTPYKz43iUlviHDdrArGMfHTK7g==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=1rh/r9E/A/YRjMbzISXno2bQizEoygFOyKpFAaeFchk=;
 b=Qk1ZOrv0f7kwoTHPKshgPVIpWxX20xAac6JnHoLNKTg61sWhjo6vUAmvrD4XeMXi7LRSuYX4lzYpt5wFbWJNzK9+N1vurpdUnxEKyUUwmAQb+hxt1wBN2gNV7FP2BAv//dwAA/NzCmhLtnzKMPCnaxuLamGWbs3gFNkUgH39OhcD9hOKiF17fWyGCKHxmkA0ZIR0oT1mKC9+ATxH4WmGFnTwfzhO2p3VVQYPlcbD15hbQw5P7WfKi0hJvCwmoWTV4fUO0rkmqL3GlWyeMtxhOkQfQCR8Y1WckRADMj6JSrwA6Cr9v21iPGyaGyeqZSz9zKtE5/wdTfEUrq1jah+LDw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=silabs.com; dmarc=pass action=none header.from=silabs.com;
 dkim=pass header.d=silabs.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=silabs.onmicrosoft.com; s=selector2-silabs-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=1rh/r9E/A/YRjMbzISXno2bQizEoygFOyKpFAaeFchk=;
 b=MknrLeFf0WGY8vhd3jAM36U3shS0+KkdkDIZd/4udp4Z+wohpfNKLsOtzeL/IxTg7e7m7MK0PjoBZJMG0zOPascE0rm95+z8yCu52aK4D0xnY9w5iPKSEWipCgOjzLOtgyJd/bohn/SNzuLPAeVzD8MP2p7ul/98Ec/E6LYgPHo=
Authentication-Results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=silabs.com;
Received: from IA1PR11MB7773.namprd11.prod.outlook.com (2603:10b6:208:3f0::21)
 by PH7PR11MB5982.namprd11.prod.outlook.com (2603:10b6:510:1e1::20) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.6838.34; Wed, 4 Oct
 2023 17:29:05 +0000
Received: from IA1PR11MB7773.namprd11.prod.outlook.com
 ([fe80::d6c8:4cb6:2594:d8f3]) by IA1PR11MB7773.namprd11.prod.outlook.com
 ([fe80::d6c8:4cb6:2594:d8f3%4]) with mapi id 15.20.6838.030; Wed, 4 Oct 2023
 17:29:05 +0000
From:   =?UTF-8?q?J=C3=A9r=C3=B4me=20Pouiller?= 
        <jerome.pouiller@silabs.com>
To:     Kalle Valo <kvalo@kernel.org>
Cc:     linux-wireless@vger.kernel.org, linux-kernel@vger.kernel.org,
        =?UTF-8?q?J=C3=A9r=C3=B4me=20Pouiller?= 
        <jerome.pouiller@silabs.com>
Subject: [PATCH v3 7/8] wifi: wfx: allow to send frames during ROC
Date:   Wed,  4 Oct 2023 19:28:42 +0200
Message-Id: <20231004172843.195332-8-jerome.pouiller@silabs.com>
X-Mailer: git-send-email 2.39.2
In-Reply-To: <20231004172843.195332-1-jerome.pouiller@silabs.com>
References: <20231004172843.195332-1-jerome.pouiller@silabs.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
X-ClientProxiedBy: DS7PR03CA0305.namprd03.prod.outlook.com
 (2603:10b6:8:2b::25) To IA1PR11MB7773.namprd11.prod.outlook.com
 (2603:10b6:208:3f0::21)
MIME-Version: 1.0
X-MS-PublicTrafficType: Email
X-MS-TrafficTypeDiagnostic: IA1PR11MB7773:EE_|PH7PR11MB5982:EE_
X-MS-Office365-Filtering-Correlation-Id: 5fb6a10d-5f25-40e7-31f9-08dbc4ff682d
X-MS-Exchange-SenderADCheck: 1
X-MS-Exchange-AntiSpam-Relay: 0
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: kyPQaPDFMKUfLOvajBe+egQxBSL1uLMbLoAvfh8xeD5pPhH9pveGfoQHDCygGXUE2mvaYO6KJJPwuVv6wTbNVbkhJwjbli/6+pc/TAbHUlL9Plu9LThxZ3wgi/zpc73LWCyqkvZrhcHWFhefv+pqJc7kKwduB3SZY5ndiUg/ZIbKvKz4Opc9UEtZ0tAP3ybsc/01xtIMCUooBd+G5kxBFp5o4KG5S2GRMgyIA2Vy17CL9EIaI5PeOaNaQmxxnkSV9Xwk2fFA4ahYA8QjT9+JyEPW6i1FBGfe3jaojYVuTVCwaZVGA2F3CrAX9x8OVSCROgVplfyy134byrAnnvgsP7mEon8r6D9nHu15rMLFyJJgBsQ3Y2r3ta0C7KJQhV/iDti9WW0r5Z37vQanuxTMoUvNEBg0DrF2eWZow05oZ7C+qA3Ez73slMHPeT/5KBW0GgrGUZpK/eLALpWaV7QbnlPrwAGEevtanCI5YvupCRdPtQTcCDaAq3SwtBsHJmt9TQjroEkmXh477Ld32Ej60I2zgYJlkNMVoPXMmAuN7P6uCZK4R13o7KmdOb4O5jhs
X-Forefront-Antispam-Report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:IA1PR11MB7773.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230031)(376002)(136003)(366004)(346002)(39850400004)(396003)(230922051799003)(451199024)(186009)(64100799003)(1800799009)(6486002)(36756003)(6512007)(38100700002)(6666004)(52116002)(86362001)(478600001)(6506007)(66556008)(66946007)(66476007)(316002)(6916009)(41300700001)(2616005)(107886003)(1076003)(8936002)(4326008)(8676002)(66574015)(5660300002)(83380400001)(2906002);DIR:OUT;SFP:1101;
X-MS-Exchange-AntiSpam-MessageData-ChunkCount: 1
X-MS-Exchange-AntiSpam-MessageData-0: =?utf-8?B?ZS9JTmtnOC9xK3FQQWEvaEJDR0tnUUtwbFJJN044VktQVDE2cnpTL0d1eGNO?=
 =?utf-8?B?bnJ2VkpQK0dDWjBoSUd1WEVmUHZVbnNPM3FuTGxBT1Q1ZGtDWmluUmcrcXVD?=
 =?utf-8?B?MlRBZ2dXcjd1MlNIUVZDWU9GaHE5VktlSGJBQW9kcjNwUWVDWUtkRllsbzdB?=
 =?utf-8?B?YlBRMWZDVUtjaDZhUzl5SFNnMWdUSjBRVWNQNmcycmtYL2Q3TUJVVEp4VSt1?=
 =?utf-8?B?ZnhnbkNsQzE3QnBVZG5VQXR4elZtZGxTZGVwV0xEZ2F0SjJ3SlprYTE3MCsz?=
 =?utf-8?B?OEF1YUhyUkhjUDhMdWZiSlhNVUpKMWlsRW1NbC9qbUtqb2tOekRrWmlsNlJ2?=
 =?utf-8?B?bWFDZXlmZlZzTGJXZUhMbHNRRUs0NGw5bGs1cmZpb2ZNVXY2MkF4SVJIRXRL?=
 =?utf-8?B?NVZtK1JyaEJhNno5YTJ6bjFNaHVDd2RISzk1UjZRODF5OXdnSksrak1hMDI5?=
 =?utf-8?B?MzZuNHgvZk4rMXJhT1VQeDhWa2l1WHp5cGFrN1VMTWFqbVNDZE9SNHgzOWh5?=
 =?utf-8?B?bURGMzBMUzVYVUwwNEg3YmdBc09wRjVWOEtZSFR2Z2k2VndWR0oydEowOEZr?=
 =?utf-8?B?NGUzM1JpZ1R5U0Q4OWZLNWtaWVF2VHpkYndrdU4zanNsYkVmS1hRUWVaR2hr?=
 =?utf-8?B?Ui9rSEZYQ3g3QTZTMUt3NVpISU1Ma0w4KzN4MWxtd056UU1ZY1BsVzBXckw1?=
 =?utf-8?B?aXljczR3RWdsK0swY3NYdUU3d0pUNTRFL29zVGx2RkFiWlUwVXk1dm95Z1Nu?=
 =?utf-8?B?bTlodzhaZWdkSXg1YmJPSUF1N1Rucnk3c1c1SnQzdnFXeXlTZXRNTC9CLy9N?=
 =?utf-8?B?YzFHWnM2RVBBbmZTZk9OK2lLMnY5THhOUXMwVDhudUJKNTZUSnk5QVgxZG96?=
 =?utf-8?B?ZzNRYWM0UVBjdkNFZlFQUXN2V3lrUk01RFdVenRxWkRwYkd1MmtXc1djL3Fn?=
 =?utf-8?B?RWhEc3FBL0hvRWw0bmMyUlVDMnVqaFF4WERONmxxNGMvb3VveXd6aThIVFBM?=
 =?utf-8?B?SFpmcDVyWVY4S2k4cVJCbUFuSGJZWHlza3pTRDRleXFrbDJKUm01VkVxOFZo?=
 =?utf-8?B?ZEg5dEJBcnhrRzVFbWxRMmFyblVaSDNGaXBNNll3K3hUWXJVUCtQWG5jQUor?=
 =?utf-8?B?L3I0eVB6Yzg5dUpGTzdJd012NUNwRXRVYXlWeFBReXhwVjgyMEFodnlZdlBx?=
 =?utf-8?B?S3M1TnZwOFBoVXo3K0xBMktJVUJYUTRJUU9HbE94c3hueGJYelB0UnlIV2w0?=
 =?utf-8?B?QkpaY2lSZHJyUjVUTXZvNGwvRDZNb0NTcTE0ODY3SFpJcVRpTEhRTGJ6ejJo?=
 =?utf-8?B?Nncwa0tVZTc5TVI4Y1lZeEx5K0VzVzBTV3VRdTAyOFF3SXVlT1ZqK3FtZEtY?=
 =?utf-8?B?L1dSY1Y3bk9TaFRIRXhwS2V1cmxnSWxtWGJJdnNTYmZxd0xPRVBqdEIwN3ZD?=
 =?utf-8?B?YjN5K3NQY2tqaVlDVUJYUW15bHZyc2VZMEp3L2lDZHRML1NJWFNrblVhVlEw?=
 =?utf-8?B?bXNrSlE0ZWlMTEdQU3pMYzdMYjI1b1BWTWVvbUVLaFlSZDI2UDFrQytjZXdW?=
 =?utf-8?B?d2taZ3JWMUNielpJOCt3TFR2QWZLTGFnQk5OeC9mTG9XNFc5UCtqVFBSRTV0?=
 =?utf-8?B?QW53eVM0UkR4R1BwdmdzTWNsYndTem1PUy9NaXZnME9YajBJSjBBQmRuWlNM?=
 =?utf-8?B?Ty9POEw2QlltUWZQWUpSNENvSWp6Q0dIc3BYaGFZRElBVmc5U2QxUGtoNm9k?=
 =?utf-8?B?amxQQXZJVjlKSUFad0lsaWxKZzZnVTMzMzhzcFA0bUxhVFBVTURVR3oyTFVu?=
 =?utf-8?B?ZjM4V01tQUN6a2NNdVIxdzFFbWdUY0x3TFAwdXpaOEF2MlcyN2o3Q0cxZmV0?=
 =?utf-8?B?ekZzUkNtcDdQN2UwSXBvSlBhYVlUeGlxS1ZEWFFaNGhjRDJKNjZzblVZK3Ft?=
 =?utf-8?B?OWpYVDFLVHoyS3JnbDJ3bE54NjFlemdTWTVUMmdwVVhETWlCckVqTThBTGZr?=
 =?utf-8?B?ZytWWFBvaUtqdlptbXlMSndTZDlkMG4wYllzM1hQd1pxT1ZGYmhoNnI0NkRv?=
 =?utf-8?B?S0c2L3FUTm9RWmZ6V015bkg3ejBFOC9RSUJGUk4ySy9xaDRiaUpQM1IrdXlC?=
 =?utf-8?B?dm1JY0c4OFN5aHU3U1o0QWNsNFVTd0wzVEh6eG9mOGM5dUIvT2lBS3BvaHNI?=
 =?utf-8?Q?TfuqZCDARASArA8hkaNrzIqmPMhYln2rD91tV1hFP2YG?=
X-OriginatorOrg: silabs.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 5fb6a10d-5f25-40e7-31f9-08dbc4ff682d
X-MS-Exchange-CrossTenant-AuthSource: IA1PR11MB7773.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 04 Oct 2023 17:29:04.8518
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 54dbd822-5231-4b20-944d-6f4abcd541fb
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: FtF1Yl9CzIFNQItwMP0uWItK6/68l9ITl5glGfq05BOG/I6OHf6QpkWVIE7PmODgDBgalGnRE7CXliKPOjlEOA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: PH7PR11MB5982
X-Spam-Status: No, score=-1.4 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,FORGED_SPF_HELO,RCVD_IN_DNSWL_NONE,RCVD_IN_MSPIKE_H2,
        SPF_HELO_PASS,SPF_NONE autolearn=no autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-wireless.vger.kernel.org>
X-Mailing-List: linux-wireless@vger.kernel.org

VW50aWwgbm93LCBhbGwgdGhlIHRyYWZmaWMgd2FzIGJsb2NrZWQgZHVyaW5nIHNjYW4gb3BlcmF0
aW9uLiBIb3dldmVyLApzY2FuIG9wZXJhdGlvbiBpcyBnb2luZyB0byBiZSB1c2VkIHRvIGltcGxl
bWVudCBSZW1haW4gT24gQ2hhbm5lbCAoUk9DKS4KSW4gdGhpcyBjYXNlLCBzcGVjaWFsIGZyYW1l
cyAobWFya2VkIHdpdGggSUVFRTgwMjExX1RYX0NUTF9UWF9PRkZDSEFOKQptdXN0IGJlIHNlbnQg
ZHVyaW5nIHRoZSBvcGVyYXRpb24uCgpUaGVzZSBmcmFtZXMgbmVlZCB0byBiZSBzZW50IG9uIHRo
ZSB2aXJ0dWFsIGludGVyZmFjZSAjMi4gVW50aWwgbm93LAp0aGlzIGludGVyZmFjZSB3YXMgb25s
eSB1c2VkIGJ5IHRoZSBkZXZpY2UgZm9yIGludGVybmFsIHB1cnBvc2UuIEJ1dApzaW5jZSBBUEkg
My45LCBpdCBjYW4gYmUgdXNlZCB0byBzZW5kIGRhdGEgZHVyaW5nIHNjYW4gb3BlcmF0aW9uICh3
ZQpoaWphY2sgdGhlIHNjYW4gcHJvY2VzcyB0byBpbXBsZW1lbnQgUk9DKS4KClRodXMsIHdlIG5l
ZWQgdG8gY2hhbmdlIGEgYml0IHRoZSB3YXkgd2UgbWF0Y2ggdGhlIGZyYW1lcyB3aXRoIHRoZQpp
bnRlcmZhY2UuCgpGb3J0dW5hdGVseSwgdGhlIGZyYW1lcyByZWNlaXZlZCBkdXJpbmcgdGhlIHNj
YW4gYXJlIG1hcmtlZCB3aXRoIHRoZQpjb3JyZWN0IGludGVyZmFjZSBudW1iZXIuIFNvIHRoZXJl
IGlzIG5vIGNoYW5nZSB0byBkbyBvbiB0aGlzIHBhcnQuCgpTaWduZWQtb2ZmLWJ5OiBKw6lyw7Rt
ZSBQb3VpbGxlciA8amVyb21lLnBvdWlsbGVyQHNpbGFicy5jb20+Ci0tLQogZHJpdmVycy9uZXQv
d2lyZWxlc3Mvc2lsYWJzL3dmeC9kYXRhX3R4LmMgfCAzNiArKysrKysrKysrKysrKysrLS0tLS0K
IGRyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvZGF0YV90eC5oIHwgIDIgKysKIGRyaXZl
cnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvcXVldWUuYyAgIHwgMzggKysrKysrKysrKysrKysr
KysrLS0tLS0KIGRyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvcXVldWUuaCAgIHwgIDEg
KwogNCBmaWxlcyBjaGFuZ2VkLCA2MiBpbnNlcnRpb25zKCspLCAxNSBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMvd2Z4L2RhdGFfdHguYyBiL2Ry
aXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvZGF0YV90eC5jCmluZGV4IGNlMmI1ZGNmZDhk
ODkuLmU4YjZkNDFmNTUxOTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFi
cy93ZngvZGF0YV90eC5jCisrKyBiL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvZGF0
YV90eC5jCkBAIC0yMjYsNiArMjI2LDE4IEBAIHN0cnVjdCB3ZnhfaGlmX3JlcV90eCAqd2Z4X3Nr
Yl90eHJlcShzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQogCXJldHVybiByZXE7CiB9CiAKK3N0cnVjdCB3
ZnhfdmlmICp3Znhfc2tiX3d2aWYoc3RydWN0IHdmeF9kZXYgKndkZXYsIHN0cnVjdCBza19idWZm
ICpza2IpCit7CisJc3RydWN0IHdmeF90eF9wcml2ICp0eF9wcml2ID0gd2Z4X3NrYl90eF9wcml2
KHNrYik7CisJc3RydWN0IHdmeF9oaWZfbXNnICpoaWYgPSAoc3RydWN0IHdmeF9oaWZfbXNnICop
c2tiLT5kYXRhOworCisJaWYgKHR4X3ByaXYtPnZpZl9pZCAhPSBoaWYtPmludGVyZmFjZSAmJiBo
aWYtPmludGVyZmFjZSAhPSAyKSB7CisJCWRldl9lcnIod2Rldi0+ZGV2LCAiY29ycnVwdGVkIHNr
YiIpOworCQlyZXR1cm4gd2Rldl90b193dmlmKHdkZXYsIGhpZi0+aW50ZXJmYWNlKTsKKwl9CisJ
cmV0dXJuIHdkZXZfdG9fd3ZpZih3ZGV2LCB0eF9wcml2LT52aWZfaWQpOworfQorCiBzdGF0aWMg
dTggd2Z4X3R4X2dldF9saW5rX2lkKHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3QgaWVlZTgw
MjExX3N0YSAqc3RhLAogCQkJICAgICBzdHJ1Y3QgaWVlZTgwMjExX2hkciAqaGRyKQogewpAQCAt
MzUyLDYgKzM2NCw3IEBAIHN0YXRpYyBpbnQgd2Z4X3R4X2lubmVyKHN0cnVjdCB3ZnhfdmlmICp3
dmlmLCBzdHJ1Y3QgaWVlZTgwMjExX3N0YSAqc3RhLCBzdHJ1Y3QKIAkvKiBGaWxsIHR4X3ByaXYg
Ki8KIAl0eF9wcml2ID0gKHN0cnVjdCB3ZnhfdHhfcHJpdiAqKXR4X2luZm8tPnJhdGVfZHJpdmVy
X2RhdGE7CiAJdHhfcHJpdi0+aWN2X3NpemUgPSB3ZnhfdHhfZ2V0X2ljdl9sZW4oaHdfa2V5KTsK
Kwl0eF9wcml2LT52aWZfaWQgPSB3dmlmLT5pZDsKIAogCS8qIEZpbGwgaGlmX21zZyAqLwogCVdB
Uk4oc2tiX2hlYWRyb29tKHNrYikgPCB3bXNnX2xlbiwgIm5vdCBlbm91Z2ggc3BhY2UgaW4gc2ti
Iik7CkBAIC0zNjIsNyArMzc1LDEwIEBAIHN0YXRpYyBpbnQgd2Z4X3R4X2lubmVyKHN0cnVjdCB3
ZnhfdmlmICp3dmlmLCBzdHJ1Y3QgaWVlZTgwMjExX3N0YSAqc3RhLCBzdHJ1Y3QKIAloaWZfbXNn
ID0gKHN0cnVjdCB3ZnhfaGlmX21zZyAqKXNrYi0+ZGF0YTsKIAloaWZfbXNnLT5sZW4gPSBjcHVf
dG9fbGUxNihza2ItPmxlbik7CiAJaGlmX21zZy0+aWQgPSBISUZfUkVRX0lEX1RYOwotCWhpZl9t
c2ctPmludGVyZmFjZSA9IHd2aWYtPmlkOworCWlmICh0eF9pbmZvLT5mbGFncyAmIElFRUU4MDIx
MV9UWF9DVExfVFhfT0ZGQ0hBTikKKwkJaGlmX21zZy0+aW50ZXJmYWNlID0gMjsKKwllbHNlCisJ
CWhpZl9tc2ctPmludGVyZmFjZSA9IHd2aWYtPmlkOwogCWlmIChza2ItPmxlbiA+IGxlMTZfdG9f
Y3B1KHd2aWYtPndkZXYtPmh3X2NhcHMuc2l6ZV9pbnBfY2hfYnVmKSkgewogCQlkZXZfd2Fybih3
dmlmLT53ZGV2LT5kZXYsCiAJCQkgInJlcXVlc3RlZCBmcmFtZSBzaXplICglZCkgaXMgbGFyZ2Vy
IHRoYW4gbWF4aW11bSBzdXBwb3J0ZWQgKCVkKVxuIiwKQEAgLTM4Myw5ICszOTksMTUgQEAgc3Rh
dGljIGludCB3ZnhfdHhfaW5uZXIoc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCBpZWVlODAy
MTFfc3RhICpzdGEsIHN0cnVjdAogCXJlcS0+ZmNfb2Zmc2V0ID0gb2Zmc2V0OwogCS8qIFF1ZXVl
IGluZGV4IGFyZSBpbnZlcnRlZCBiZXR3ZWVuIGZpcm13YXJlIGFuZCBMaW51eCAqLwogCXJlcS0+
cXVldWVfaWQgPSAzIC0gcXVldWVfaWQ7Ci0JcmVxLT5wZWVyX3N0YV9pZCA9IHdmeF90eF9nZXRf
bGlua19pZCh3dmlmLCBzdGEsIGhkcik7Ci0JcmVxLT5yZXRyeV9wb2xpY3lfaW5kZXggPSB3Znhf
dHhfZ2V0X3JldHJ5X3BvbGljeV9pZCh3dmlmLCB0eF9pbmZvKTsKLQlyZXEtPmZyYW1lX2Zvcm1h
dCA9IHdmeF90eF9nZXRfZnJhbWVfZm9ybWF0KHR4X2luZm8pOworCWlmICh0eF9pbmZvLT5mbGFn
cyAmIElFRUU4MDIxMV9UWF9DVExfVFhfT0ZGQ0hBTikgeworCQlyZXEtPnBlZXJfc3RhX2lkID0g
SElGX0xJTktfSURfTk9UX0FTU09DSUFURUQ7CisJCXJlcS0+cmV0cnlfcG9saWN5X2luZGV4ID0g
SElGX1RYX1JFVFJZX1BPTElDWV9JTlZBTElEOworCQlyZXEtPmZyYW1lX2Zvcm1hdCA9IEhJRl9G
UkFNRV9GT1JNQVRfTk9OX0hUOworCX0gZWxzZSB7CisJCXJlcS0+cGVlcl9zdGFfaWQgPSB3Znhf
dHhfZ2V0X2xpbmtfaWQod3ZpZiwgc3RhLCBoZHIpOworCQlyZXEtPnJldHJ5X3BvbGljeV9pbmRl
eCA9IHdmeF90eF9nZXRfcmV0cnlfcG9saWN5X2lkKHd2aWYsIHR4X2luZm8pOworCQlyZXEtPmZy
YW1lX2Zvcm1hdCA9IHdmeF90eF9nZXRfZnJhbWVfZm9ybWF0KHR4X2luZm8pOworCX0KIAlpZiAo
dHhfaW5mby0+ZHJpdmVyX3JhdGVzWzBdLmZsYWdzICYgSUVFRTgwMjExX1RYX1JDX1NIT1JUX0dJ
KQogCQlyZXEtPnNob3J0X2dpID0gMTsKIAlpZiAodHhfaW5mby0+ZmxhZ3MgJiBJRUVFODAyMTFf
VFhfQ1RMX1NFTkRfQUZURVJfRFRJTSkKQEAgLTUwMSw3ICs1MjMsNyBAQCB2b2lkIHdmeF90eF9j
b25maXJtX2NiKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBjb25zdCBzdHJ1Y3Qgd2Z4X2hpZl9jbmZf
dHggKmFyZykKIAl9CiAJdHhfaW5mbyA9IElFRUU4MDIxMV9TS0JfQ0Ioc2tiKTsKIAl0eF9wcml2
ID0gd2Z4X3NrYl90eF9wcml2KHNrYik7Ci0Jd3ZpZiA9IHdkZXZfdG9fd3ZpZih3ZGV2LCAoKHN0
cnVjdCB3ZnhfaGlmX21zZyAqKXNrYi0+ZGF0YSktPmludGVyZmFjZSk7CisJd3ZpZiA9IHdmeF9z
a2Jfd3ZpZih3ZGV2LCBza2IpOwogCVdBUk5fT04oIXd2aWYpOwogCWlmICghd3ZpZikKIAkJcmV0
dXJuOwpAQCAtNTYzLDcgKzU4NSw2IEBAIHZvaWQgd2Z4X2ZsdXNoKHN0cnVjdCBpZWVlODAyMTFf
aHcgKmh3LCBzdHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmLCB1MzIgcXVldWVzLCBiCiAJc3RydWN0
IHdmeF9kZXYgKndkZXYgPSBody0+cHJpdjsKIAlzdHJ1Y3Qgc2tfYnVmZl9oZWFkIGRyb3BwZWQ7
CiAJc3RydWN0IHdmeF92aWYgKnd2aWY7Ci0Jc3RydWN0IHdmeF9oaWZfbXNnICpoaWY7CiAJc3Ry
dWN0IHNrX2J1ZmYgKnNrYjsKIAogCXNrYl9xdWV1ZV9oZWFkX2luaXQoJmRyb3BwZWQpOwpAQCAt
NTc5LDggKzYwMCw3IEBAIHZvaWQgd2Z4X2ZsdXNoKHN0cnVjdCBpZWVlODAyMTFfaHcgKmh3LCBz
dHJ1Y3QgaWVlZTgwMjExX3ZpZiAqdmlmLCB1MzIgcXVldWVzLCBiCiAJaWYgKHdkZXYtPmNoaXBf
ZnJvemVuKQogCQl3ZnhfcGVuZGluZ19kcm9wKHdkZXYsICZkcm9wcGVkKTsKIAl3aGlsZSAoKHNr
YiA9IHNrYl9kZXF1ZXVlKCZkcm9wcGVkKSkgIT0gTlVMTCkgewotCQloaWYgPSAoc3RydWN0IHdm
eF9oaWZfbXNnICopc2tiLT5kYXRhOwotCQl3dmlmID0gd2Rldl90b193dmlmKHdkZXYsIGhpZi0+
aW50ZXJmYWNlKTsKKwkJd3ZpZiA9IHdmeF9za2Jfd3ZpZih3ZGV2LCBza2IpOwogCQlpZWVlODAy
MTFfdHhfaW5mb19jbGVhcl9zdGF0dXMoSUVFRTgwMjExX1NLQl9DQihza2IpKTsKIAkJd2Z4X3Nr
Yl9kdG9yKHd2aWYsIHNrYik7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvd2lyZWxlc3Mv
c2lsYWJzL3dmeC9kYXRhX3R4LmggYi9kcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMvd2Z4L2Rh
dGFfdHguaAppbmRleCBhNWI4MGVhY2NlMzlhLi4wNjIxYjgyMTAzYmVmIDEwMDY0NAotLS0gYS9k
cml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMvd2Z4L2RhdGFfdHguaAorKysgYi9kcml2ZXJzL25l
dC93aXJlbGVzcy9zaWxhYnMvd2Z4L2RhdGFfdHguaApAQCAtMzYsNiArMzYsNyBAQCBzdHJ1Y3Qg
d2Z4X3R4X3BvbGljeV9jYWNoZSB7CiBzdHJ1Y3Qgd2Z4X3R4X3ByaXYgewogCWt0aW1lX3QgeG1p
dF90aW1lc3RhbXA7CiAJdW5zaWduZWQgY2hhciBpY3Zfc2l6ZTsKKwl1bnNpZ25lZCBjaGFyIHZp
Zl9pZDsKIH07CiAKIHZvaWQgd2Z4X3R4X3BvbGljeV9pbml0KHN0cnVjdCB3ZnhfdmlmICp3dmlm
KTsKQEAgLTQ3LDUgKzQ4LDYgQEAgdm9pZCB3ZnhfZmx1c2goc3RydWN0IGllZWU4MDIxMV9odyAq
aHcsIHN0cnVjdCBpZWVlODAyMTFfdmlmICp2aWYsIHUzMiBxdWV1ZXMsIGIKIAogc3RydWN0IHdm
eF90eF9wcml2ICp3Znhfc2tiX3R4X3ByaXYoc3RydWN0IHNrX2J1ZmYgKnNrYik7CiBzdHJ1Y3Qg
d2Z4X2hpZl9yZXFfdHggKndmeF9za2JfdHhyZXEoc3RydWN0IHNrX2J1ZmYgKnNrYik7CitzdHJ1
Y3Qgd2Z4X3ZpZiAqd2Z4X3NrYl93dmlmKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgc2tf
YnVmZiAqc2tiKTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC93aXJlbGVzcy9z
aWxhYnMvd2Z4L3F1ZXVlLmMgYi9kcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMvd2Z4L3F1ZXVl
LmMKaW5kZXggMzdmNDkyZTVkM2JlYS4uZTYxYjg2ZjIxMWU1MyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9xdWV1ZS5jCisrKyBiL2RyaXZlcnMvbmV0L3dpcmVs
ZXNzL3NpbGFicy93ZngvcXVldWUuYwpAQCAtNjgsMTMgKzY4LDE2IEBAIHZvaWQgd2Z4X3R4X3F1
ZXVlc19pbml0KHN0cnVjdCB3ZnhfdmlmICp3dmlmKQogCWZvciAoaSA9IDA7IGkgPCBJRUVFODAy
MTFfTlVNX0FDUzsgKytpKSB7CiAJCXNrYl9xdWV1ZV9oZWFkX2luaXQoJnd2aWYtPnR4X3F1ZXVl
W2ldLm5vcm1hbCk7CiAJCXNrYl9xdWV1ZV9oZWFkX2luaXQoJnd2aWYtPnR4X3F1ZXVlW2ldLmNh
Yik7CisJCXNrYl9xdWV1ZV9oZWFkX2luaXQoJnd2aWYtPnR4X3F1ZXVlW2ldLm9mZmNoYW4pOwog
CQl3dmlmLT50eF9xdWV1ZVtpXS5wcmlvcml0eSA9IHByaW9yaXRpZXNbaV07CiAJfQogfQogCiBi
b29sIHdmeF90eF9xdWV1ZV9lbXB0eShzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwgc3RydWN0IHdmeF9x
dWV1ZSAqcXVldWUpCiB7Ci0JcmV0dXJuIHNrYl9xdWV1ZV9lbXB0eV9sb2NrbGVzcygmcXVldWUt
Pm5vcm1hbCkgJiYgc2tiX3F1ZXVlX2VtcHR5X2xvY2tsZXNzKCZxdWV1ZS0+Y2FiKTsKKwlyZXR1
cm4gc2tiX3F1ZXVlX2VtcHR5X2xvY2tsZXNzKCZxdWV1ZS0+bm9ybWFsKSAmJgorCSAgICAgICBz
a2JfcXVldWVfZW1wdHlfbG9ja2xlc3MoJnF1ZXVlLT5jYWIpICYmCisJICAgICAgIHNrYl9xdWV1
ZV9lbXB0eV9sb2NrbGVzcygmcXVldWUtPm9mZmNoYW4pOwogfQogCiB2b2lkIHdmeF90eF9xdWV1
ZXNfY2hlY2tfZW1wdHkoc3RydWN0IHdmeF92aWYgKnd2aWYpCkBAIC0xMDMsOCArMTA2LDkgQEAg
c3RhdGljIHZvaWQgX193ZnhfdHhfcXVldWVfZHJvcChzdHJ1Y3Qgd2Z4X3ZpZiAqd3ZpZiwKIHZv
aWQgd2Z4X3R4X3F1ZXVlX2Ryb3Aoc3RydWN0IHdmeF92aWYgKnd2aWYsIHN0cnVjdCB3ZnhfcXVl
dWUgKnF1ZXVlLAogCQkgICAgICAgc3RydWN0IHNrX2J1ZmZfaGVhZCAqZHJvcHBlZCkKIHsKLQlf
X3dmeF90eF9xdWV1ZV9kcm9wKHd2aWYsICZxdWV1ZS0+Y2FiLCBkcm9wcGVkKTsKIAlfX3dmeF90
eF9xdWV1ZV9kcm9wKHd2aWYsICZxdWV1ZS0+bm9ybWFsLCBkcm9wcGVkKTsKKwlfX3dmeF90eF9x
dWV1ZV9kcm9wKHd2aWYsICZxdWV1ZS0+Y2FiLCBkcm9wcGVkKTsKKwlfX3dmeF90eF9xdWV1ZV9k
cm9wKHd2aWYsICZxdWV1ZS0+b2ZmY2hhbiwgZHJvcHBlZCk7CiAJd2FrZV91cCgmd3ZpZi0+d2Rl
di0+dHhfZGVxdWV1ZSk7CiB9CiAKQEAgLTExMyw3ICsxMTcsOSBAQCB2b2lkIHdmeF90eF9xdWV1
ZXNfcHV0KHN0cnVjdCB3ZnhfdmlmICp3dmlmLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQogCXN0cnVj
dCB3ZnhfcXVldWUgKnF1ZXVlID0gJnd2aWYtPnR4X3F1ZXVlW3NrYl9nZXRfcXVldWVfbWFwcGlu
Zyhza2IpXTsKIAlzdHJ1Y3QgaWVlZTgwMjExX3R4X2luZm8gKnR4X2luZm8gPSBJRUVFODAyMTFf
U0tCX0NCKHNrYik7CiAKLQlpZiAodHhfaW5mby0+ZmxhZ3MgJiBJRUVFODAyMTFfVFhfQ1RMX1NF
TkRfQUZURVJfRFRJTSkKKwlpZiAodHhfaW5mby0+ZmxhZ3MgJiBJRUVFODAyMTFfVFhfQ1RMX1RY
X09GRkNIQU4pCisJCXNrYl9xdWV1ZV90YWlsKCZxdWV1ZS0+b2ZmY2hhbiwgc2tiKTsKKwllbHNl
IGlmICh0eF9pbmZvLT5mbGFncyAmIElFRUU4MDIxMV9UWF9DVExfU0VORF9BRlRFUl9EVElNKQog
CQlza2JfcXVldWVfdGFpbCgmcXVldWUtPmNhYiwgc2tiKTsKIAllbHNlCiAJCXNrYl9xdWV1ZV90
YWlsKCZxdWV1ZS0+bm9ybWFsLCBza2IpOwpAQCAtMTIzLDEzICsxMjksMTEgQEAgdm9pZCB3Znhf
cGVuZGluZ19kcm9wKHN0cnVjdCB3ZnhfZGV2ICp3ZGV2LCBzdHJ1Y3Qgc2tfYnVmZl9oZWFkICpk
cm9wcGVkKQogewogCXN0cnVjdCB3ZnhfcXVldWUgKnF1ZXVlOwogCXN0cnVjdCB3ZnhfdmlmICp3
dmlmOwotCXN0cnVjdCB3ZnhfaGlmX21zZyAqaGlmOwogCXN0cnVjdCBza19idWZmICpza2I7CiAK
IAlXQVJOKCF3ZGV2LT5jaGlwX2Zyb3plbiwgIiVzIHNob3VsZCBvbmx5IGJlIHVzZWQgdG8gcmVj
b3ZlciBhIGZyb3plbiBkZXZpY2UiLCBfX2Z1bmNfXyk7CiAJd2hpbGUgKChza2IgPSBza2JfZGVx
dWV1ZSgmd2Rldi0+dHhfcGVuZGluZykpICE9IE5VTEwpIHsKLQkJaGlmID0gKHN0cnVjdCB3Znhf
aGlmX21zZyAqKXNrYi0+ZGF0YTsKLQkJd3ZpZiA9IHdkZXZfdG9fd3ZpZih3ZGV2LCBoaWYtPmlu
dGVyZmFjZSk7CisJCXd2aWYgPSB3Znhfc2tiX3d2aWYod2Rldiwgc2tiKTsKIAkJaWYgKHd2aWYp
IHsKIAkJCXF1ZXVlID0gJnd2aWYtPnR4X3F1ZXVlW3NrYl9nZXRfcXVldWVfbWFwcGluZyhza2Ip
XTsKIAkJCVdBUk5fT04oc2tiX2dldF9xdWV1ZV9tYXBwaW5nKHNrYikgPiAzKTsKQEAgLTE1NSw3
ICsxNTksNyBAQCBzdHJ1Y3Qgc2tfYnVmZiAqd2Z4X3BlbmRpbmdfZ2V0KHN0cnVjdCB3ZnhfZGV2
ICp3ZGV2LCB1MzIgcGFja2V0X2lkKQogCQlpZiAocmVxLT5wYWNrZXRfaWQgIT0gcGFja2V0X2lk
KQogCQkJY29udGludWU7CiAJCXNwaW5fdW5sb2NrX2JoKCZ3ZGV2LT50eF9wZW5kaW5nLmxvY2sp
OwotCQl3dmlmID0gd2Rldl90b193dmlmKHdkZXYsIGhpZi0+aW50ZXJmYWNlKTsKKwkJd3ZpZiA9
IHdmeF9za2Jfd3ZpZih3ZGV2LCBza2IpOwogCQlpZiAod3ZpZikgewogCQkJcXVldWUgPSAmd3Zp
Zi0+dHhfcXVldWVbc2tiX2dldF9xdWV1ZV9tYXBwaW5nKHNrYildOwogCQkJV0FSTl9PTihza2Jf
Z2V0X3F1ZXVlX21hcHBpbmcoc2tiKSA+IDMpOwpAQCAtMjQ2LDYgKzI1MCwyNiBAQCBzdGF0aWMg
c3RydWN0IHNrX2J1ZmYgKndmeF90eF9xdWV1ZXNfZ2V0X3NrYihzdHJ1Y3Qgd2Z4X2RldiAqd2Rl
dikKIAkJfQogCX0KIAorCXd2aWYgPSBOVUxMOworCXdoaWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0
ZSh3ZGV2LCB3dmlmKSkgIT0gTlVMTCkgeworCQlmb3IgKGkgPSAwOyBpIDwgbnVtX3F1ZXVlczsg
aSsrKSB7CisJCQlza2IgPSBza2JfZGVxdWV1ZSgmcXVldWVzW2ldLT5vZmZjaGFuKTsKKwkJCWlm
ICghc2tiKQorCQkJCWNvbnRpbnVlOworCQkJaGlmID0gKHN0cnVjdCB3ZnhfaGlmX21zZyAqKXNr
Yi0+ZGF0YTsKKwkJCS8qIE9mZmNoYW4gZnJhbWVzIGFyZSBhc3NpZ25lZCB0byBhIHNwZWNpYWwg
aW50ZXJmYWNlLgorCQkJICogVGhlIG9ubHkgaW50ZXJmYWNlIGFsbG93ZWQgdG8gc2VuZCBkYXRh
IGR1cmluZyBzY2FuLgorCQkJICovCisJCQlXQVJOX09OKGhpZi0+aW50ZXJmYWNlICE9IDIpOwor
CQkJYXRvbWljX2luYygmcXVldWVzW2ldLT5wZW5kaW5nX2ZyYW1lcyk7CisJCQl0cmFjZV9xdWV1
ZXNfc3RhdHMod2RldiwgcXVldWVzW2ldKTsKKwkJCXJldHVybiBza2I7CisJCX0KKwl9CisKKwlp
ZiAobXV0ZXhfaXNfbG9ja2VkKCZ3ZGV2LT5zY2FuX2xvY2spKQorCQlyZXR1cm4gTlVMTDsKKwog
CXd2aWYgPSBOVUxMOwogCXdoaWxlICgod3ZpZiA9IHd2aWZfaXRlcmF0ZSh3ZGV2LCB3dmlmKSkg
IT0gTlVMTCkgewogCQlpZiAoIXd2aWYtPmFmdGVyX2R0aW1fdHhfYWxsb3dlZCkKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3NpbGFicy93ZngvcXVldWUuaCBiL2RyaXZlcnMvbmV0
L3dpcmVsZXNzL3NpbGFicy93ZngvcXVldWUuaAppbmRleCA0NzMxZGViY2E5M2QyLi42ODU3ZmJk
NjBmYmFkIDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC93aXJlbGVzcy9zaWxhYnMvd2Z4L3F1ZXVl
LmgKKysrIGIvZHJpdmVycy9uZXQvd2lyZWxlc3Mvc2lsYWJzL3dmeC9xdWV1ZS5oCkBAIC0xNyw2
ICsxNyw3IEBAIHN0cnVjdCB3ZnhfdmlmOwogc3RydWN0IHdmeF9xdWV1ZSB7CiAJc3RydWN0IHNr
X2J1ZmZfaGVhZCBub3JtYWw7CiAJc3RydWN0IHNrX2J1ZmZfaGVhZCBjYWI7IC8qIENvbnRlbnQg
QWZ0ZXIgKERUSU0pIEJlYWNvbiAqLworCXN0cnVjdCBza19idWZmX2hlYWQgb2ZmY2hhbjsKIAlh
dG9taWNfdCAgICAgICAgICAgIHBlbmRpbmdfZnJhbWVzOwogCWludCAgICAgICAgICAgICAgICAg
cHJpb3JpdHk7CiB9OwotLSAKMi4zOS4yCgo=
